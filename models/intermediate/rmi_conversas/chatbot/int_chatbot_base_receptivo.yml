version: 2

models:
  - name: int_chatbot_base_receptivo
    description: "Modelo intermediário que transforma e enriquece os dados brutos de fluxos de URA do Wetalkie, extraindo informações detalhadas de sessões de chatbot receptivo. Inclui a extração de metadados da sessão, informações do contato, mensagens, e dados de temporalidade."
    columns:
      - name: id_sessao
        description: "Identificador único da sessão de atendimento (reply ID)."
        tests:
          - not_null

      - name: protocolo
        description: "Número de protocolo associado ao atendimento."

      - name: canal
        description: "Canal de comunicação onde o atendimento foi realizado (ex: WhatsApp, Web, etc.)."

      - name: inicio_data
        description: "Data de início do atendimento, ajustada para o fuso horário de São Paulo."

      - name: inicio_datahora
        description: "Data e hora de início do atendimento, ajustada para o fuso horário de São Paulo."

      - name: fim_datahora
        description: "Data e hora de término do atendimento, ajustada para o fuso horário de São Paulo."

      - name: id
        description: "ID da conversa extraído do JSON."

      - name: ura
        description: "Estrutura (struct) contendo informações da URA (Unidade de Resposta Audível)."
        columns:
          - name: id
            description: "ID da URA."
          - name: nome
            description: "Nome da URA."

      - name: observacao
        description: "Observações gerais sobre o atendimento."

      - name: origem
        description: "Origem do contato (ex: número de telefone)."

      - name: descricao
        description: "Descrição do atendimento."

      - name: operador
        description: "Nome do operador que realizou o atendimento."

      - name: usuario_finalizacao
        description: "Usuário que finalizou o atendimento."

      - name: data_primeiro_enfileiramento
        description: "Timestamp do primeiro enfileiramento do atendimento."

      - name: data_envio_operador
        description: "Timestamp do envio do atendimento para um operador."

      - name: data_ultimo_enfileiramento
        description: "Timestamp do último enfileiramento do atendimento."

      - name: fila
        description: "Fila para a qual o atendimento foi direcionado."

      - name: tags
        description: "Tags (etiquetas) associadas ao atendimento em formato JSON."

      - name: tabulacao
        description: "Estrutura (struct) com informações de tabulação do atendimento."
        columns:
          - name: nome
            description: "Nome da tabulação."
          - name: id
            description: "ID da tabulação."

      - name: transferencias
        description: "Array de transferências ocorridas durante o atendimento."

      - name: contato
        description: "Estrutura (struct) com informações do contato."
        columns:
          - name: nome
            description: "Nome do contato."
          - name: id
            description: "ID do contato."

      - name: mensagens
        description: "Array contendo o histórico de mensagens trocadas durante o atendimento."

      - name: ano_particao
        description: "Ano extraído da data de início do atendimento, usado para particionamento."

      - name: mes_particao
        description: "Mês extraído da data de início do atendimento, usado para particionamento."

      - name: data_particao
        description: "Data de início do atendimento, usada como campo de particionamento principal da tabela."
